$ bun --watch src/index.ts
[IronCondorOrderbook] CONSTRUCTOR called for timeframe 500ms at 2025-10-09T18:12:42.750Z
[IronCondorOrderbook] Config for 500ms: numColumns=25, totalColumns=25, timeRange=12.5s
[IronCondorOrderbook] Generating contract table for timeframe 500: columns=25, rows=21
[IronCondorOrderbook] First contract will start at: 2025-10-09T18:12:42.751Z
[IronCondorOrderbook] Generated 25 columns with 21 contracts each
[IronCondorOrderbook] Column time boundaries:
  Column 0: 2025-10-09T18:12:42.751Z to 2025-10-09T18:12:43.251Z
  Column 1: 2025-10-09T18:12:43.251Z to 2025-10-09T18:12:43.751Z
  Column 2: 2025-10-09T18:12:43.751Z to 2025-10-09T18:12:44.251Z
  Column 3: 2025-10-09T18:12:44.251Z to 2025-10-09T18:12:44.751Z
  Column 4: 2025-10-09T18:12:44.751Z to 2025-10-09T18:12:45.251Z
[IronCondorOrderbook] CONSTRUCTOR called for timeframe 1000ms at 2025-10-09T18:12:42.757Z
[IronCondorOrderbook] Config for 1000ms: numColumns=25, totalColumns=25, timeRange=25s
[IronCondorOrderbook] Generating contract table for timeframe 1000: columns=25, rows=21
[IronCondorOrderbook] First contract will start at: 2025-10-09T18:12:42.757Z
[IronCondorOrderbook] Generated 25 columns with 21 contracts each
[IronCondorOrderbook] Column time boundaries:
  Column 0: 2025-10-09T18:12:42.757Z to 2025-10-09T18:12:43.757Z
  Column 1: 2025-10-09T18:12:43.757Z to 2025-10-09T18:12:44.757Z
  Column 2: 2025-10-09T18:12:44.757Z to 2025-10-09T18:12:45.757Z
  Column 3: 2025-10-09T18:12:45.757Z to 2025-10-09T18:12:46.757Z
  Column 4: 2025-10-09T18:12:46.757Z to 2025-10-09T18:12:47.757Z
[IronCondorOrderbook] CONSTRUCTOR called for timeframe 2000ms at 2025-10-09T18:12:42.779Z
[IronCondorOrderbook] Config for 2000ms: numColumns=25, totalColumns=25, timeRange=50s
[IronCondorOrderbook] Generating contract table for timeframe 2000: columns=25, rows=21
[IronCondorOrderbook] First contract will start at: 2025-10-09T18:12:42.779Z
[IronCondorOrderbook] Generated 25 columns with 21 contracts each
[IronCondorOrderbook] Column time boundaries:
  Column 0: 2025-10-09T18:12:42.779Z to 2025-10-09T18:12:44.779Z
  Column 1: 2025-10-09T18:12:44.779Z to 2025-10-09T18:12:46.779Z
  Column 2: 2025-10-09T18:12:46.779Z to 2025-10-09T18:12:48.779Z
  Column 3: 2025-10-09T18:12:48.779Z to 2025-10-09T18:12:50.779Z
  Column 4: 2025-10-09T18:12:50.779Z to 2025-10-09T18:12:52.779Z
[IronCondorOrderbook] CONSTRUCTOR called for timeframe 4000ms at 2025-10-09T18:12:42.847Z
[IronCondorOrderbook] Config for 4000ms: numColumns=25, totalColumns=25, timeRange=100s
[IronCondorOrderbook] Generating contract table for timeframe 4000: columns=25, rows=21
[IronCondorOrderbook] First contract will start at: 2025-10-09T18:12:42.847Z
[IronCondorOrderbook] Generated 25 columns with 21 contracts each
[IronCondorOrderbook] Column time boundaries:
  Column 0: 2025-10-09T18:12:42.847Z to 2025-10-09T18:12:46.847Z
  Column 1: 2025-10-09T18:12:46.847Z to 2025-10-09T18:12:50.847Z
  Column 2: 2025-10-09T18:12:50.847Z to 2025-10-09T18:12:54.847Z
  Column 3: 2025-10-09T18:12:54.847Z to 2025-10-09T18:12:58.847Z
  Column 4: 2025-10-09T18:12:58.847Z to 2025-10-09T18:13:02.847Z
[IronCondorOrderbook] CONSTRUCTOR called for timeframe 10000ms at 2025-10-09T18:12:42.861Z
[IronCondorOrderbook] Config for 10000ms: numColumns=25, totalColumns=25, timeRange=250s
[IronCondorOrderbook] Generating contract table for timeframe 10000: columns=25, rows=21
[IronCondorOrderbook] First contract will start at: 2025-10-09T18:12:42.861Z
[IronCondorOrderbook] Generated 25 columns with 21 contracts each
[IronCondorOrderbook] Column time boundaries:
  Column 0: 2025-10-09T18:12:42.861Z to 2025-10-09T18:12:52.861Z
  Column 1: 2025-10-09T18:12:52.861Z to 2025-10-09T18:13:02.861Z
  Column 2: 2025-10-09T18:13:02.861Z to 2025-10-09T18:13:12.861Z
  Column 3: 2025-10-09T18:13:12.861Z to 2025-10-09T18:13:22.861Z
  Column 4: 2025-10-09T18:13:22.861Z to 2025-10-09T18:13:32.861Z
{"timestamp":"2025-10-09T18:12:42.939Z","level":"info","service":"UserService","message":"UserService initialized (no auth mode)"}
{"timestamp":"2025-10-09T18:12:42.983Z","level":"info","service":"GameEngineManager","message":"Clearing house listeners setup"}
{"timestamp":"2025-10-09T18:12:43.007Z","level":"info","service":"MessageRouter","message":"Handler registered","type":"auth"}
{"timestamp":"2025-10-09T18:12:43.007Z","level":"info","service":"MessageRouter","message":"Handler registered","type":"join_game"}
{"timestamp":"2025-10-09T18:12:43.007Z","level":"info","service":"MessageRouter","message":"Handler registered","type":"leave_game"}
{"timestamp":"2025-10-09T18:12:43.008Z","level":"info","service":"MessageRouter","message":"Handler registered","type":"place_trade"}
{"timestamp":"2025-10-09T18:12:43.008Z","level":"info","service":"MessageRouter","message":"Handler registered","type":"get_state"}
{"timestamp":"2025-10-09T18:12:43.008Z","level":"info","service":"MessageRouter","message":"Handler registered","type":"get_leaderboard"}
{"timestamp":"2025-10-09T18:12:43.008Z","level":"info","service":"MessageRouter","message":"Handler registered","type":"get_game_config"}
{"timestamp":"2025-10-09T18:12:43.008Z","level":"info","service":"TradeRushApp","message":"Message handlers registered"}
{"timestamp":"2025-10-09T18:12:43.027Z","level":"info","service":"TradeRushApp","message":"Starting TradeRush app..."}
{"timestamp":"2025-10-09T18:12:43.121Z","level":"info","service":"WebSocketServer","message":"WebSocket server started","port":8080,"host":"localhost"}
[ClearingHouse] Price feed started
{"timestamp":"2025-10-09T18:12:43.122Z","level":"info","service":"GameEngineManager","message":"Started price feed"}
{"timestamp":"2025-10-09T18:12:43.122Z","level":"info","service":"StreamingService","message":"Streaming service started"}
{"timestamp":"2025-10-09T18:12:43.122Z","level":"info","service":"TradeRushApp","message":"TradeRush app started successfully","port":8080,"host":"localhost"}
{"timestamp":"2025-10-09T18:12:44.335Z","level":"info","service":"ConnectionManager","message":"Connection added","connectionId":"conn_1760033564331_k1vc3tavh"}
{"timestamp":"2025-10-09T18:12:44.340Z","level":"info","service":"WebSocketServer","message":"WebSocket connection opened","connectionId":"conn_1760033564331_k1vc3tavh"}
{"timestamp":"2025-10-09T18:12:44.439Z","level":"info","service":"UserService","message":"New user created","userId":"user_1760033564418_o2xt75c07","username":"player_ois2qwucc"}
{"timestamp":"2025-10-09T18:12:44.450Z","level":"info","service":"ConnectionManager","message":"Connection authenticated","connectionId":"conn_1760033564331_k1vc3tavh","userId":"user_1760033564418_o2xt75c07"}
{"timestamp":"2025-10-09T18:12:44.454Z","level":"info","service":"AuthHandler","message":"User authenticated","connectionId":"conn_1760033564331_k1vc3tavh","userId":"user_1760033564418_o2xt75c07","username":"player_ois2qwucc"}
{"timestamp":"2025-10-09T18:12:44.543Z","level":"error","service":"GameHandler","message":"Failed to leave game","userId":"user_1760033564418_o2xt75c07","error":{"errorName":"NoActiveSessionError","errorMessage":"No active game session found","stack":"NoActiveSessionError: No active game session found\n    at leaveSession (/Users/eugene/Projects/traderush/backend/src/app/services/SessionManager.ts:107:20)\n    at leaveSession (/Users/eugene/Projects/traderush/backend/src/app/services/SessionManager.ts:103:22)\n    at handleLeaveGame (/Users/eugene/Projects/traderush/backend/src/app/handlers/GameHandler.ts:99:50)\n    at handleLeaveGame (/Users/eugene/Projects/traderush/backend/src/app/handlers/GameHandler.ts:89:3)\n    at route (/Users/eugene/Projects/traderush/backend/src/app/core/MessageRouter.ts:113:30)\n    at route (/Users/eugene/Projects/traderush/backend/src/app/core/MessageRouter.ts:64:15)\n    at handleMessage (/Users/eugene/Projects/traderush/backend/src/app/core/WebSocketServer.ts:170:49)\n    at handleMessage (/Users/eugene/Projects/traderush/backend/src/app/core/WebSocketServer.ts:147:31)"}}
{"timestamp":"2025-10-09T18:12:44.618Z","level":"error","service":"MessageRouter","message":"Error routing message","type":"leave_game","connectionId":"conn_1760033564331_k1vc3tavh","error":{"errorName":"NoActiveSessionError","errorMessage":"No active game session found","stack":"NoActiveSessionError: No active game session found\n    at leaveSession (/Users/eugene/Projects/traderush/backend/src/app/services/SessionManager.ts:107:20)\n    at leaveSession (/Users/eugene/Projects/traderush/backend/src/app/services/SessionManager.ts:103:22)\n    at handleLeaveGame (/Users/eugene/Projects/traderush/backend/src/app/handlers/GameHandler.ts:99:50)\n    at handleLeaveGame (/Users/eugene/Projects/traderush/backend/src/app/handlers/GameHandler.ts:89:3)\n    at route (/Users/eugene/Projects/traderush/backend/src/app/core/MessageRouter.ts:113:30)\n    at route (/Users/eugene/Projects/traderush/backend/src/app/core/MessageRouter.ts:64:15)\n    at handleMessage (/Users/eugene/Projects/traderush/backend/src/app/core/WebSocketServer.ts:170:49)\n    at handleMessage (/Users/eugene/Projects/traderush/backend/src/app/core/WebSocketServer.ts:147:31)"}}
{"timestamp":"2025-10-09T18:12:44.620Z","level":"error","service":"ErrorHandler","message":"WebSocket error","connectionId":"conn_1760033564331_k1vc3tavh","error":{"errorName":"NoActiveSessionError","errorMessage":"No active game session found","stack":"NoActiveSessionError: No active game session found\n    at leaveSession (/Users/eugene/Projects/traderush/backend/src/app/services/SessionManager.ts:107:20)\n    at leaveSession (/Users/eugene/Projects/traderush/backend/src/app/services/SessionManager.ts:103:22)\n    at handleLeaveGame (/Users/eugene/Projects/traderush/backend/src/app/handlers/GameHandler.ts:99:50)\n    at handleLeaveGame (/Users/eugene/Projects/traderush/backend/src/app/handlers/GameHandler.ts:89:3)\n    at route (/Users/eugene/Projects/traderush/backend/src/app/core/MessageRouter.ts:113:30)\n    at route (/Users/eugene/Projects/traderush/backend/src/app/core/MessageRouter.ts:64:15)\n    at handleMessage (/Users/eugene/Projects/traderush/backend/src/app/core/WebSocketServer.ts:170:49)\n    at handleMessage (/Users/eugene/Projects/traderush/backend/src/app/core/WebSocketServer.ts:147:31)"}}
{"timestamp":"2025-10-09T18:12:44.693Z","level":"info","service":"SessionManager","message":"Session created","sessionId":"iron_condor_session_1760033564693","userId":"user_1760033564418_o2xt75c07","gameMode":"box_hit","timeframe":2000}
{"timestamp":"2025-10-09T18:12:44.696Z","level":"info","service":"GameEngineManager","message":"Creating game engine","gameMode":"box_hit","timeframe":2000}
{"timestamp":"2025-10-09T18:12:44.697Z","level":"info","service":"BoxHitEngine","message":"Initializing Box Hit engine","timeframe":2000}
{"timestamp":"2025-10-09T18:12:44.698Z","level":"info","service":"BoxHitEngine","message":"Box Hit engine started","timeframe":2000}
{"timestamp":"2025-10-09T18:12:44.698Z","level":"info","service":"GameEngineManager","message":"Game engine created and started","gameMode":"box_hit","timeframe":2000}
{"timestamp":"2025-10-09T18:12:44.719Z","level":"info","service":"GameHandler","message":"User joined game","userId":"user_1760033564418_o2xt75c07","sessionId":"iron_condor_session_1760033564693","gameMode":"box_hit","timeframe":2000}
{"timestamp":"2025-10-09T18:12:46.290Z","level":"info","service":"ConnectionManager","message":"Connection added","connectionId":"conn_1760033566290_c4j6fpujg"}
{"timestamp":"2025-10-09T18:12:46.290Z","level":"info","service":"WebSocketServer","message":"WebSocket connection opened","connectionId":"conn_1760033566290_c4j6fpujg"}
{"timestamp":"2025-10-09T18:12:46.291Z","level":"info","service":"UserService","message":"New user created","userId":"user_1760033566291_4d9ttevlg","username":"player_tqmi50zb0"}
{"timestamp":"2025-10-09T18:12:46.291Z","level":"info","service":"ConnectionManager","message":"Connection authenticated","connectionId":"conn_1760033566290_c4j6fpujg","userId":"user_1760033566291_4d9ttevlg"}
{"timestamp":"2025-10-09T18:12:46.291Z","level":"info","service":"AuthHandler","message":"User authenticated","connectionId":"conn_1760033566290_c4j6fpujg","userId":"user_1760033566291_4d9ttevlg","username":"player_tqmi50zb0"}
{"timestamp":"2025-10-09T18:12:49.307Z","level":"info","service":"WebSocketServer","message":"WebSocket connection closed","connectionId":"conn_1760033564331_k1vc3tavh","userId":"user_1760033564418_o2xt75c07","code":1001,"reason":""}
{"timestamp":"2025-10-09T18:12:49.310Z","level":"info","service":"ConnectionManager","message":"Connection removed","connectionId":"conn_1760033564331_k1vc3tavh","userId":"user_1760033564418_o2xt75c07"}
{"timestamp":"2025-10-09T18:12:49.318Z","level":"info","service":"SessionManager","message":"User disconnected but session kept alive","userId":"user_1760033564418_o2xt75c07"}
{"timestamp":"2025-10-09T18:12:49.318Z","level":"info","service":"MessageRouter","message":"User disconnected","userId":"user_1760033564418_o2xt75c07"}
{"timestamp":"2025-10-09T18:12:49.320Z","level":"info","service":"WebSocketServer","message":"WebSocket connection closed","connectionId":"conn_1760033566290_c4j6fpujg","userId":"user_1760033566291_4d9ttevlg","code":1001,"reason":""}
{"timestamp":"2025-10-09T18:12:49.320Z","level":"info","service":"ConnectionManager","message":"Connection removed","connectionId":"conn_1760033566290_c4j6fpujg","userId":"user_1760033566291_4d9ttevlg"}
{"timestamp":"2025-10-09T18:12:49.321Z","level":"info","service":"SessionManager","message":"User disconnected but session kept alive","userId":"user_1760033566291_4d9ttevlg"}
{"timestamp":"2025-10-09T18:12:49.321Z","level":"info","service":"MessageRouter","message":"User disconnected","userId":"user_1760033566291_4d9ttevlg"}

Shutting down server...
{"timestamp":"2025-10-09T18:13:17.127Z","level":"info","service":"TradeRushApp","message":"Stopping TradeRush app..."}
{"timestamp":"2025-10-09T18:13:17.128Z","level":"info","service":"StreamingService","message":"Streaming service stopped"}
[ClearingHouse] Price feed stopped
{"timestamp":"2025-10-09T18:13:17.128Z","level":"info","service":"BoxHitEngine","message":"Box Hit engine stopped","timeframe":2000}
{"timestamp":"2025-10-09T18:13:17.128Z","level":"info","service":"BoxHitEngine","message":"Box Hit engine stopped","timeframe":2000}
{"timestamp":"2025-10-09T18:13:17.128Z","level":"info","service":"GameEngineManager","message":"All engines stopped"}
{"timestamp":"2025-10-09T18:13:17.129Z","level":"info","service":"ConnectionManager","message":"Closing all connections","count":0}
{"timestamp":"2025-10-09T18:13:17.129Z","level":"info","service":"WebSocketServer","message":"WebSocket server stopped"}
{"timestamp":"2025-10-09T18:13:17.129Z","level":"info","service":"TradeRushApp","message":"TradeRush app stopped"}
